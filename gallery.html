<!DOCTYPE html>
<html>
<head>

</head>
<body> 
<!-- <a href="#">link text</a> -->
<button id='LightPower'>電源</button>
<script src="https://threejs.org/build/three.min.js"></script>
<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script src="https://threejs.org/examples/js/controls/OrbitControls.js"></script>
<script src="https://jyunming-chen.github.io/tutsplus/js/KeyboardState.js"></script>


<script>

class Lamps{
    constructor(x, y, z, style) {
    this.powerState = true;
	this.x = x;
	this.y = y;
	this.z = z;
	
	if(style === 1){
		this.Light = new THREE.PointLight(0xFFFFFF, 0.4);
		this.Light.position.set(this.x, this.y, this.z);
		scene.add(this.Light);
		
		let geometry = new THREE.CylinderGeometry(4, 4, 1);
		let material = new THREE.MeshBasicMaterial( {color: 0x9D9D9D} );
		var PointLightLamp = new THREE.Mesh( geometry, material );
		PointLightLamp.position.set(this.x, this.y, this.z);
		//PointLightLamp.rotation.x = Math.PI/2;
		scene.add( PointLightLamp );
		
		//var sphereSize = 1;
		//const pointLightHelper = new THREE.PointLightHelper(this.Light, sphereSize);
		//scene.add(pointLightHelper);
		
	}else if(style === 2){
		this.Light = new THREE.SpotLight(0xffffff, 1, 250, Math.PI / 6, 0.974);
		this.Light.position.set(this.x, this.y, this.z);
		//this.spotLight.target = drawing;
		scene.add(this.Light);
		
		let geometry = new THREE.CylinderGeometry( 3, 3, 5 );
		let material = new THREE.MeshBasicMaterial( {color: 0x7B7B7B} );
		var spotLightLamp = new THREE.Mesh( geometry, material );
		spotLightLamp.position.set(this.x, this.y, this.z);
		scene.add(spotLightLamp);

	}
	/**/
  }
  controlLamps(){
		this.powerState = ! this.powerState;
		if(this.powerState===true){
		  this.Light.intensity = 0.5;
		  scene.add(this.Light);
		}
		else{
		  this.Light.intensity = 0;
		  scene.add(this.Light);
		}
 }
}

var camera, scene, renderer;

init();
animate();

function init() {

	scene = new THREE.Scene();

	renderer = new THREE.WebGLRenderer();
	renderer.setSize(window.innerWidth, window.innerHeight);
	renderer.setClearColor(0xffffff);
	document.body.appendChild(renderer.domElement);

	camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 1, 1000);
	camera.position.z = 500; // camera at (0,0,500)
	let controls = new THREE.OrbitControls(camera, renderer.domElement);

 ////////////////////////////////////////////////////////
///light

	let sunLight = new THREE.DirectionalLight(0xdddddd, 0.3); // color, intensity, distance, decay
    sunLight.position.y = 15;
    scene.add(sunLight);

///Lamps
	MainLight1 = new Lamps(-180, 150, 0, 1); 
	MainLight2 = new Lamps(180, 150, -100, 1); 
	MainLight3 = new Lamps(180, 150, 100, 1); 	
	
	//drawLight1 = new Lamps(-210, 150, 130, 2); 
	
	$('#LightPower').click(function() {
		MainLight1.controlLamps();
		MainLight2.controlLamps();
		MainLight3.controlLamps();
		}
	);
	//light.controlLamps();
	//scene.add(light);
	

  
///Chairs
	var chair = buildChair();
	var chair1 = chair.clone();
	chair1.position.set (-45, 0, 70);
	chair1.rotation.y = Math.PI/2;
	var chair2 = chair.clone();
	chair2.position.set (-45, 0, -70);
	chair2.rotation.y = Math.PI/2;
  
	scene.add (chair1,chair2);

///Floor
  var floor = buildFloor();
  scene.add (floor);

///Walls
	var wallGroup = new THREE.Group();
	//walls around
  wallL = buildWalls(380,120,4,2);
  wallL.rotation.y = Math.PI/2;
  wallR = wallL.clone();
  wallR.rotation.y = -Math.PI/2;
  wallL.position.set (-260, 60, 0);
  wallR.position.set (260, 60, 0);
  
  wallB = buildWalls(520,120,4,2);
  wallF = wallB.clone();
  wallF.rotation.y = Math.PI;
  wallB.position.set (0, 60, -190);
  wallF.position.set (0, 60, 190);
  
  wallGroup.add(wallL, wallR, wallB, wallF);
  
  //hallway's wall  
  wallHallway1 = buildWalls(200, 120, 4, 1);
  wallHallway2 = wallHallway1.clone();
  wallHallway1.position.set(-160,60,105);
  wallHallway2.position.set(-160,60,-105);
  
  wallHallway3 = buildWalls(75, 120, 4, 1);
  wallHallway3.rotation.y = Math.PI/2;
  wallHallway4 = wallHallway3.clone();
  wallHallway3.position.set(-61,60,-70);
  wallHallway4.position.set(-61,60,70);
  
  wallGroup.add(wallHallway1, wallHallway2, wallHallway3, wallHallway4);
  
  //room's wall
  wallRoomMid = buildWalls(100,120,4,1);
  wallRoomMid.position.set(180,60,0);
  
  wallRoom1 = buildWalls(120,120,4,1);
  wallRoom1.rotation.y = Math.PI/2;
  wallRoom2 = wallRoom1.clone();
  wallRoom1.position.set(80,60,-90);
  wallRoom2.position.set(80,60,90);
  
  wallGroup.add(wallRoomMid, wallRoom1, wallRoom2);
  scene.add (wallGroup);
}

function buildFloor(){
	var FloorGroup = new THREE.Group();
	let woodTex = new THREE.TextureLoader().load("https://i.imgur.com/DrvlmNW.jpg?1");
  let mat = new THREE.MeshLambertMaterial({
    map: woodTex
  });
 var floorTop = new THREE.Mesh(new THREE.BoxGeometry(520, 2, 380), mat);
	FloorGroup.add(floorTop);
  return FloorGroup;

}

function buildWalls(w, h, d, style) {
	let wall;
  if(style === 1){
    wall = new THREE.Mesh(new THREE.BoxGeometry(w, h, d), new THREE.MeshLambertMaterial({
    color: 0xFFF3EE	
    }));
  }
  if(style === 2){
  	wall = new THREE.Mesh(new THREE.PlaneGeometry(w, h, d), new THREE.MeshLambertMaterial({
    color: 0xFFF3EE	
    }));
  }
  return wall;
}

function buildChair() {
  var ChairGroup = new THREE.Group();
  var woodTex = new THREE.TextureLoader().load("https://i.imgur.com/DrvlmNW.jpg?1");
  var mat = new THREE.MeshLambertMaterial({
    map: woodTex
  });
  var boxTop = new THREE.Mesh(new THREE.BoxGeometry(65, 4, 20), mat);
  var boxLeg1 = new THREE.Mesh(new THREE.BoxGeometry(4, 22, 20), mat);
  var boxLeg2 = new THREE.Mesh(new THREE.BoxGeometry(4, 22, 20), mat);
  boxTop.position.set(0, 25, 0);
  boxLeg1.position.set(-30.5, 12, 0);
  boxLeg2.position.set(30.5, 12, 0);
  ChairGroup.add(boxTop, boxLeg1, boxLeg2);
  return ChairGroup;
}

function animate() {

  requestAnimationFrame(animate);
  renderer.render(scene, camera);

}

</script>
</body>
</html>